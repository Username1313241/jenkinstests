# –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ Jenkins LTS
FROM jenkins/jenkins:lts

# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ root –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
USER root

# üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN apt-get update && apt-get install -y \
    wget \
    curl \
    unzip \
    software-properties-common \
    apt-transport-https

# üß∞ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ .NET SDK 8.0
RUN wget https://packages.microsoft.com/config/debian/11/packages-microsoft-prod.deb -O packages-microsoft-prod.deb \
    && dpkg -i packages-microsoft-prod.deb \
    && rm packages-microsoft-prod.deb \
    && apt-get update \
    && apt-get install -y dotnet-sdk-8.0

# üìä –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Allure 2.27.0
RUN curl -fLo allure.zip https://repo.maven.apache.org/maven2/io/qameta/allure/allure-commandline/2.27.0/allure-commandline-2.27.0.zip \
    && echo "‚úÖ Allure ZIP downloaded" \
    && unzip -l allure.zip \
    && unzip allure.zip -d /opt/ \
    && mv /opt/allure-2.27.0 /opt/allure \
    && ln -s /opt/allure/bin/allure /usr/bin/allure \
    && rm -rf allure.zip

# üßπ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ apt
RUN apt-get clean

# –í–æ–∑–≤—Ä–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Jenkins
USER jenkins

# –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è Jenkins
WORKDIR /var/jenkins_home